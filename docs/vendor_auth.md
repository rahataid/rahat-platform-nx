# Vendor Wallet Authentication Documentation

This document outlines the process for authorizing vendors to access protected APIs by utilizing wallet-based authentication.

## Wallet Authentication Process

### Steps for Vendors

The authentication process involves several key steps on the vendor's side to ensure secure access:

1. **Initiating the Authentication Request:**

   - The vendor initiates the process by sending a request to obtain a login challenge.
   - **Request Parameters:**
     - `clientId` (String): An optional identifier for the client.
     - `ip` (String): An optional IP address of the request origin.
     - `address` (String): The vendor's wallet address, which is mandatory.

2. **Receiving the Challenge:**

   - Upon request, the vendor receives a challenge from the server. This challenge is a unique, time-sensitive token that needs to be signed with the vendor's private key.

3. **Signing the Challenge:**

   - The vendor uses their private key to sign the received challenge. This step is crucial for proving the ownership of the wallet address without revealing the private key.

4. **Requesting Wallet Login:**

   - With the signed challenge, the vendor sends another request to log in.
   - **Login Request Parameters:**
     - `signature` (String): The signature generated by signing the challenge.
     - `challenge` (String): The original challenge token received from the server.

5. **Receiving Authentication Tokens:**
   - Upon successful authentication, the vendor receives an access token along with user details.
   - These credentials are then stored securely in the vendor's local storage for subsequent API requests.

## Securing the API

### Backend Implementation

The backend system must implement role-based authentication guards for APIs to ensure that only authorized vendors can access protected endpoints.

### Vendor API Requests

For every API request, vendors must append the received access token to the Authorization header. This token serves as proof of authentication and authorizes the vendor to access the guarded API endpoints.

## Vendor App UI Flow

### During Create Wallet

- At the start of the vendor registration process, immediately after the wallet is created, an API call is made to retrieve a challenge.
- The vendor then signs this challenge and proceeds with the wallet login process.

### Access Token expiration

- If the access token expires, the vendor is redirected to a new page.
- This page includes a button to refresh the application.
- Upon clicking this button, an API call is made to obtain a new challenge.
- After successfully logging in with the wallet again, the vendor is redirected back to the homepage.
- This process allows the vendor to regain access to authorized APIs and continue their activities without interruption.
